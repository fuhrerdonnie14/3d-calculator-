<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Print Calculators</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary: #4CAF50;
            --primary-dark: #45a049;
            --secondary: #2196F3;
            --background: #f5f5f5;
            --surface: #ffffff;
            --text: #333333;
            --text-secondary: #666666;
            --border: #e0e0e0;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --radius: 12px;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --background: #1a1a1a;
                --surface: #2d2d2d;
                --text: #ffffff;
                --text-secondary: #cccccc;
                --border: #404040;
                --shadow: 0 2px 10px rgba(0,0,0,0.3);
            }
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
            padding: 0;
            margin: 0;
            min-height: 100vh;
        }

        .app {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text);
        }

        .tabs {
            display: flex;
            background: var(--surface);
            border-radius: var(--radius);
            padding: 4px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .tab {
            flex: 1;
            padding: 16px;
            text-align: center;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .card h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h2::before {
            content: '';
            width: 4px;
            height: 20px;
            border-radius: 2px;
        }

        .fdm-card h2::before { background: #4CAF50; }
        .sla-card h2::before { background: #9C27B0; }
        .profit-card h2::before { background: #FF9800; }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text);
            font-size: 16px;
        }

        input, select {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: var(--surface);
            color: var(--text);
            font-size: 16px;
        }

        .input-with-unit {
            position: relative;
        }

        .unit {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 16px;
        }

        button {
            padding: 16px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-sla {
            background: #9C27B0;
            color: white;
        }

        .btn-sla:hover {
            background: #7B1FA2;
        }

        .btn-profit {
            background: #FF9800;
            color: white;
        }

        .btn-profit:hover {
            background: #F57C00;
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--background);
        }

        .result {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: var(--radius);
            padding: 24px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }

        .result.show {
            display: block;
        }

        .total-cost {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .breakdown {
            text-align: left;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .breakdown-item:last-child {
            border-bottom: none;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }

        .project-save {
            margin-top: 20px;
            padding: 20px;
            background: var(--surface);
            border-radius: var(--radius);
            border: 2px dashed var(--border);
        }

        .saved-projects {
            margin-top: 20px;
        }

        .project-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: var(--surface);
            border-radius: 8px;
            margin-bottom: 12px;
            border: 1px solid var(--border);
            cursor: pointer;
        }

        .project-item:hover {
            background: var(--background);
        }

        .project-info {
            flex: 1;
        }

        .project-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .project-details {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .project-cost {
            font-weight: 700;
            font-size: 18px;
        }

        .empty-projects {
            text-align: center;
            color: var(--text-secondary);
            padding: 40px 20px;
        }

        .metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .metric-card {
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            margin: 5px 0;
        }

        .metric-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .profit-positive { color: #4CAF50; }
        .profit-negative { color: #f44336; }
        .markup-color { color: #FFC107; }
        .margin-color { color: #2196F3; }

        .warning {
            background: rgba(244, 67, 54, 0.9);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            display: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .quick-prices {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .quick-price-btn {
            padding: 10px;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .quick-price-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <h1>üßÆ 3D Print Calculators</h1>
            <p>–í—Å–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('fdm')">üîÑ FDM</button>
            <button class="tab" onclick="switchTab('sla')">üß™ SLA</button>
            <button class="tab" onclick="switchTab('profit')">üí∞ –ü—Ä–∏–±—ã–ª—å</button>
        </div>

        <!-- FDM –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä -->
        <div id="fdm-tab" class="tab-content active">
            <div class="card fdm-card">
                <h2>–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã FDM</h2>
                
                <div class="form-group">
                    <label for="fdmProjectName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:</label>
                    <input type="text" id="fdmProjectName" placeholder="–ú–æ—è FDM –º–æ–¥–µ–ª—å" value="FDM –ø—Ä–æ–µ–∫—Ç">
                </div>

                <div class="form-group">
                    <label for="filamentType">–¢–∏–ø –ø–ª–∞—Å—Ç–∏–∫–∞:</label>
                    <select id="filamentType">
                        <option value="pla">PLA</option>
                        <option value="petg">PETG</option>
                        <option value="abs">ABS</option>
                        <option value="asa">ASA</option>
                        <option value="tpu">TPU</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="filamentPrice">–¶–µ–Ω–∞ –∫–∞—Ç—É—à–∫–∏ (—Ä—É–±):</label>
                    <div class="input-with-unit">
                        <input type="number" id="filamentPrice" value="1500" step="0.01">
                        <span class="unit">‚ÇΩ</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="fdmModelWeight">–í–µ—Å –º–æ–¥–µ–ª–∏ (–≥):</label>
                    <div class="input-with-unit">
                        <input type="number" id="fdmModelWeight" value="20" step="0.01">
                        <span class="unit">–≥</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="fdmPrintTime">–í—Ä–µ–º—è –ø–µ—á–∞—Ç–∏:</label>
                    <div class="input-with-unit">
                        <input type="number" id="fdmPrintTime" value="5" step="0.01">
                        <span class="unit">—á</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>–≠–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ FDM</h2>
                
                <div class="form-group">
                    <label for="fdmPrinterPower">–ú–æ—â–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (–í—Ç):</label>
                    <div class="input-with-unit">
                        <input type="number" id="fdmPrinterPower" value="200">
                        <span class="unit">–í—Ç</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="fdmElectricityPrice">–°—Ç–æ–∏–º–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏:</label>
                    <div class="input-with-unit">
                        <input type="number" id="fdmElectricityPrice" value="5.0" step="0.01">
                        <span class="unit">‚ÇΩ/–∫–í—Ç¬∑—á</span>
                    </div>
                </div>
            </div>

            <button class="btn-primary" onclick="calculateFDM()">üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å FDM</button>

            <div id="fdmResult" class="result">
                <div class="total-cost" id="fdmTotalCost">0.00 ‚ÇΩ</div>
                <div>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å FDM –ø–µ—á–∞—Ç–∏</div>
                
                <div class="breakdown">
                    <div class="breakdown-item">
                        <span>–ü–ª–∞—Å—Ç–∏–∫:</span>
                        <span id="fdmCostPlastic">0.00 ‚ÇΩ</span>
                    </div>
                    <div class="breakdown-item">
                        <span>–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ:</span>
                        <span id="fdmCostElectricity">0.00 ‚ÇΩ</span>
                    </div>
                    <div class="breakdown-item">
                        <span>–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è:</span>
                        <span id="fdmCostDepreciation">0.00 ‚ÇΩ</span>
                    </div>
                </div>
            </div>

            <div class="project-save">
                <div class="form-group">
                    <label for="fdmSaveName">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∫–∞–∫:</label>
                    <input type="text" id="fdmSaveName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞">
                </div>
                <button class="btn-secondary" onclick="saveFDMProject()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
            </div>
        </div>

        <!-- SLA –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä -->
        <div id="sla-tab" class="tab-content">
            <div class="card sla-card">
                <h2>–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SLA</h2>
                
                <div class="form-group">
                    <label for="slaProjectName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:</label>
                    <input type="text" id="slaProjectName" placeholder="–ú–æ—è SLA –º–æ–¥–µ–ª—å" value="SLA –ø—Ä–æ–µ–∫—Ç">
                </div>

                <div class="form-group">
                    <label for="resinType">–¢–∏–ø —Å–º–æ–ª—ã:</label>
                    <select id="resinType">
                        <option value="standard">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è</option>
                        <option value="tough">–ü—Ä–æ—á–Ω–∞—è</option>
                        <option value="flexible">–ì–∏–±–∫–∞—è</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="resinPrice">–¶–µ–Ω–∞ —Å–º–æ–ª—ã (—Ä—É–±/–∫–≥):</label>
                    <div class="input-with-unit">
                        <input type="number" id="resinPrice" value="1900" step="0.01">
                        <span class="unit">‚ÇΩ</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="resinVolume">–û–±—ä–µ–º —Å–º–æ–ª—ã (–º–ª):</label>
                    <div class="input-with-unit">
                        <input type="number" id="resinVolume" value="60" step="1">
                        <span class="unit">–º–ª</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="slaPrintTime">–í—Ä–µ–º—è –ø–µ—á–∞—Ç–∏:</label>
                    <div class="input-with-unit">
                        <input type="number" id="slaPrintTime" value="6" step="0.01">
                        <span class="unit">—á</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ SLA</h2>
                
                <div class="form-group">
                    <label for="alcoholCost">–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–ø–∏—Ä—Ç–∞ –¥–ª—è –ø—Ä–æ–º—ã–≤–∫–∏:</label>
                    <div class="input-with-unit">
                        <input type="number" id="alcoholCost" value="50" step="0.01">
                        <span class="unit">‚ÇΩ</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="supportRemovalTime">–í—Ä–µ–º—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–µ–∫:</label>
                    <div class="input-with-unit">
                        <input type="number" id="supportRemovalTime" value="0.25" step="0.01">
                        <span class="unit">—á</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="operatorHourlyRate">–°—Ç–∞–≤–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ (—Ä—É–±/—á–∞—Å):</label>
                    <div class="input-with-unit">
                        <input type="number" id="operatorHourlyRate" value="0" step="0.01">
                        <span class="unit">‚ÇΩ/—á</span>
                    </div>
                </div>
            </div>

            <button class="btn-sla" onclick="calculateSLA()">üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å SLA</button>

            <div id="slaResult" class="result">
                <div class="total-cost" id="slaTotalCost">0.00 ‚ÇΩ</div>
                <div>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å SLA –ø–µ—á–∞—Ç–∏</div>
                
                <div class="breakdown">
                    <div class="breakdown-item">
                        <span>–°–º–æ–ª–∞:</span>
                        <span id="slaCostResin">0.00 ‚ÇΩ</span>
                    </div>
                    <div class="breakdown-item">
                        <span>–ü—Ä–æ–º—ã–≤–∫–∞ —Å–ø–∏—Ä—Ç–æ–º:</span>
                        <span id="slaCostAlcohol">0.00 ‚ÇΩ</span>
                    </div>
                    <div class="breakdown-item">
                        <span>–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ:</span>
                        <span id="slaCostElectricity">0.00 ‚ÇΩ</span>
                    </div>
                    <div class="breakdown-item">
                        <span>–ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è:</span>
                        <span id="slaCostDepreciation">0.00 ‚ÇΩ</span>
                    </div>
                    <div class="breakdown-item">
                        <span>–†–∞–±–æ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞:</span>
                        <span id="slaCostOperator">0.00 ‚ÇΩ</span>
                    </div>
                </div>
            </div>

            <div class="project-save">
                <div class="form-group">
                    <label for="slaSaveName">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∫–∞–∫:</label>
                    <input type="text" id="slaSaveName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞">
                </div>
                <button class="btn-secondary" onclick="saveSLAProject()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
            </div>
        </div>

        <!-- –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏ -->
        <div id="profit-tab" class="tab-content">
            <div class="card profit-card">
                <h2>–í—ã–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞</h2>
                
                <div class="form-group">
                    <label for="projectSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç:</label>
                    <select id="projectSelect" onchange="loadSelectedProject()">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="profitProjectName">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" id="profitProjectName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞" value="–¢–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑">
                </div>

                <div class="form-group">
                    <label for="profitCostPrice">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (—Ä—É–±):</label>
                    <div class="input-with-unit">
                        <input type="number" id="profitCostPrice" placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é" step="0.01">
                        <span class="unit">‚ÇΩ</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="profitSalePrice">–¶–µ–Ω–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ (—Ä—É–±):</label>
                    <div class="input-with-unit">
                        <input type="number" id="profitSalePrice" value="1000" step="0.01">
                        <span class="unit">‚ÇΩ</span>
                    </div>
                    
                    <div class="quick-prices">
                        <div class="quick-price-btn" onclick="setPrice(500)">500‚ÇΩ</div>
                        <div class="quick-price-btn" onclick="setPrice(750)">750‚ÇΩ</div>
                        <div class="quick-price-btn" onclick="setPrice(1000)">1000‚ÇΩ</div>
                        <div class="quick-price-btn" onclick="setPrice(1500)">1500‚ÇΩ</div>
                        <div class="quick-price-btn" onclick="setPrice(2000)">2000‚ÇΩ</div>
                        <div class="quick-price-btn" onclick="setPrice(2500)">2500‚ÇΩ</div>
                    </div>
                </div>

                <button class="btn-profit" onclick="calculateProfit()">üí∏ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏–±—ã–ª—å</button>
            </div>

            <div id="profitResult" class="result">
                <div class="total-cost" id="profitTotal">0 ‚ÇΩ</div>
                <div>–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                
                <div class="metrics">
                    <div class="metric-card">
                        <div class="metric-label">–ù–∞—Ü–µ–Ω–∫–∞</div>
                        <div class="metric-value markup-color" id="profitMarkup">0%</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å</div>
                        <div class="metric-value margin-color" id="profitMargin">0%</div>
                    </div>
                </div>

                <div id="profitWarning" class="warning">
                    ‚ö†Ô∏è –í—ã –ø—Ä–æ–¥–∞–µ—Ç–µ —Å–µ–±–µ –≤ —É–±—ã—Ç–æ–∫!
                </div>
            </div>

            <div class="card saved-projects">
                <h2>üìä –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h2>
                <div id="projectsList">
                    <div class="empty-projects">
                        –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤<br>
                        <small>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ FDM –∏–ª–∏ SLA –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞—Ö</small>
                    </div>
                </div>
                
                <button class="btn-secondary" onclick="clearAllProjects()" style="width: 100%; margin-top: 10px;">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã
                </button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let savedProjects = JSON.parse(localStorage.getItem('printProjects') || '[]');
        let currentFDMCalculation = null;
        let currentSLACalculation = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            loadProjects();
            calculateFDM();
            calculateSLA();
            calculateProfit();
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            if (tabName === 'profit') {
                loadProjects();
            }
        }

        // ===== FDM –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† =====
        function calculateFDM() {
            const filamentPrice = parseFloat(document.getElementById('filamentPrice').value) || 0;
            const modelWeight = parseFloat(document.getElementById('fdmModelWeight').value) || 0;
            const printTime = parseFloat(document.getElementById('fdmPrintTime').value) || 0;
            const printerPower = parseFloat(document.getElementById('fdmPrinterPower').value) || 0;
            const electricityPrice = parseFloat(document.getElementById('fdmElectricityPrice').value) || 0;
            const printerCost = 30000; // –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä–∞
            const printerLifespan = 5000; // –°—Ä–æ–∫ —Å–ª—É–∂–±—ã –≤ —á–∞—Å–∞—Ö

            // –†–∞—Å—á–µ—Ç—ã
            const plasticCost = (modelWeight / 1000) * filamentPrice;
            const electricityCost = (printerPower * printTime / 1000) * electricityPrice;
            const depreciationCost = (printerCost / printerLifespan) * printTime;

            const totalCost = plasticCost + electricityCost + depreciationCost;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            document.getElementById('fdmTotalCost').textContent = totalCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('fdmCostPlastic').textContent = plasticCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('fdmCostElectricity').textContent = electricityCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('fdmCostDepreciation').textContent = depreciationCost.toFixed(2) + ' ‚ÇΩ';
            
            document.getElementById('fdmResult').classList.add('show');

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
            currentFDMCalculation = {
                type: 'fdm',
                name: document.getElementById('fdmProjectName').value,
                cost: totalCost,
                details: { plasticCost, electricityCost, depreciationCost },
                params: { modelWeight, printTime, filamentPrice }
            };
        }

        function saveFDMProject() {
            if (!currentFDMCalculation) return;
            
            const saveName = document.getElementById('fdmSaveName').value || currentFDMCalculation.name;
            const project = {
                ...currentFDMCalculation,
                name: saveName,
                timestamp: new Date().toISOString(),
                id: Date.now().toString()
            };
            
            savedProjects.push(project);
            localStorage.setItem('printProjects', JSON.stringify(savedProjects));
            loadProjects();
            alert('FDM –ø—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ' + saveName);
            document.getElementById('fdmSaveName').value = '';
        }

        // ===== SLA –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† =====
        function calculateSLA() {
            const resinPrice = parseFloat(document.getElementById('resinPrice').value) || 0;
            const resinVolume = parseFloat(document.getElementById('resinVolume').value) || 0;
            const printTime = parseFloat(document.getElementById('slaPrintTime').value) || 0;
            const alcoholCost = parseFloat(document.getElementById('alcoholCost').value) || 0;
            const supportRemovalTime = parseFloat(document.getElementById('supportRemovalTime').value) || 0;
            const operatorHourlyRate = parseFloat(document.getElementById('operatorHourlyRate').value) || 0;
            const printerCost = 15000;
            const hoursPerMonth = 70;
            const printerPower = 60;
            const electricityPrice = 5.0;

            // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å–º–æ–ª—ã (–ø–ª–æ—Ç–Ω–æ—Å—Ç—å 1.15 –≥/–º–ª)
            const resinWeight = resinVolume * 1.15;
            const resinCost = (resinWeight / 1000) * resinPrice;

            // –≠–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏—è
            const electricityCost = (printerPower * printTime / 1000) * electricityPrice;

            // –ê–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è
            const depreciationCost = (printerCost / (hoursPerMonth * 12)) * printTime;

            // –û–ø–µ—Ä–∞—Ç–æ—Ä - –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ —Å—Ç–∞–≤–∫–∞!
            const operatorCost = operatorHourlyRate > 0 ? (supportRemovalTime * operatorHourlyRate) : 0;

            const totalCost = resinCost + alcoholCost + electricityCost + depreciationCost + operatorCost;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            document.getElementById('slaTotalCost').textContent = totalCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('slaCostResin').textContent = resinCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('slaCostAlcohol').textContent = alcoholCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('slaCostElectricity').textContent = electricityCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('slaCostDepreciation').textContent = depreciationCost.toFixed(2) + ' ‚ÇΩ';
            document.getElementById('slaCostOperator').textContent = operatorCost.toFixed(2) + ' ‚ÇΩ';
            
            document.getElementById('slaResult').classList.add('show');

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
            currentSLACalculation = {
                type: 'sla',
                name: document.getElementById('slaProjectName').value,
                cost: totalCost,
                details: { resinCost, alcoholCost, electricityCost, depreciationCost, operatorCost },
                params: { resinVolume, printTime, resinPrice }
            };
        }

        function saveSLAProject() {
            if (!currentSLACalculation) return;
            
            const saveName = document.getElementById('slaSaveName').value || currentSLACalculation.name;
            const project = {
                ...currentSLACalculation,
                name: saveName,
                timestamp: new Date().toISOString(),
                id: Date.now().toString()
            };
            
            savedProjects.push(project);
            localStorage.setItem('printProjects', JSON.stringify(savedProjects));
            loadProjects();
            alert('SLA –ø—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ' + saveName);
            document.getElementById('slaSaveName').value = '';
        }

        // ===== –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–† –ü–†–ò–ë–´–õ–ò =====
        function loadProjects() {
            const projectSelect = document.getElementById('projectSelect');
            const projectsList = document.getElementById('projectsList');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º select
            projectSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç --</option>';
            savedProjects.forEach(project => {
                const option = document.createElement('option');
                option.value = project.id;
                option.textContent = `${project.type.toUpperCase()}: ${project.name} (${project.cost.toFixed(0)}‚ÇΩ)`;
                projectSelect.appendChild(option);
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
            if (savedProjects.length === 0) {
                projectsList.innerHTML = `
                    <div class="empty-projects">
                        –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤<br>
                        <small>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã –≤ FDM –∏–ª–∏ SLA –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞—Ö</small>
                    </div>
                `;
                return;
            }
            
            projectsList.innerHTML = savedProjects.map(project => `
                <div class="project-item" onclick="loadProjectToProfit('${project.id}')">
                    <div class="project-info">
                        <div class="project-name">${project.type.toUpperCase()}: ${project.name}</div>
                        <div class="project-details">
                            ${new Date(project.timestamp).toLocaleDateString('ru-RU')} ‚Ä¢ 
                            ${project.params.modelWeight || project.params.resinVolume || 0}${project.type === 'fdm' ? '–≥' : '–º–ª'} ‚Ä¢ 
                            ${project.params.printTime}—á
                        </div>
                    </div>
                    <div class="project-cost">${project.cost.toFixed(0)}‚ÇΩ</div>
                </div>
            `).join('');
        }

        function loadSelectedProject() {
            const projectId = document.getElementById('projectSelect').value;
            if (projectId) {
                loadProjectToProfit(projectId);
            }
        }

        function loadProjectToProfit(projectId) {
            const project = savedProjects.find(p => p.id === projectId);
            if (project) {
                document.getElementById('profitProjectName').value = project.name;
                document.getElementById('profitCostPrice').value = project.cost.toFixed(2);
                calculateProfit();
            }
        }

        function calculateProfit() {
            const costPrice = parseFloat(document.getElementById('profitCostPrice').value) || 0;
            const salePrice = parseFloat(document.getElementById('profitSalePrice').value) || 0;

            if (costPrice <= 0 || salePrice <= 0) return;

            const netProfit = salePrice - costPrice;
            const markup = ((salePrice - costPrice) / costPrice) * 100;
            const margin = ((salePrice - costPrice) / salePrice) * 100;

            document.getElementById('profitTotal').textContent = netProfit.toFixed(0) + ' ‚ÇΩ';
            document.getElementById('profitMarkup').textContent = markup.toFixed(1) + '%';
            document.getElementById('profitMargin').textContent = margin.toFixed(1) + '%';

            const profitElement = document.getElementById('profitTotal');
            const warningElement = document.getElementById('profitWarning');
            
            if (netProfit < 0) {
                profitElement.className = 'total-cost profit-negative';
                warningElement.style.display = 'block';
            } else {
                profitElement.className = 'total-cost profit-positive';
                warningElement.style.display = 'none';
            }

            document.getElementById('profitResult').classList.add('show');
        }

        function setPrice(price) {
            document.getElementById('profitSalePrice').value = price;
            calculateProfit();
        }

        function clearAllProjects() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã?')) {
                savedProjects = [];
                localStorage.setItem('printProjects', '[]');
                loadProjects();
                alert('–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã —É–¥–∞–ª–µ–Ω—ã');
            }
        }

        // –ê–≤—Ç–æ—Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π
        document.querySelectorAll('#fdm-tab input, #fdm-tab select').forEach(element => {
            element.addEventListener('input', calculateFDM);
        });

        document.querySelectorAll('#sla-tab input, #sla-tab select').forEach(element => {
            element.addEventListener('input', calculateSLA);
        });

        document.querySelectorAll('#profit-tab input, #profit-tab select').forEach(element => {
            element.addEventListener('input', calculateProfit);
        });
    </script>
</body>
</html>